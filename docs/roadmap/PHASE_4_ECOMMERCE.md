## ğŸ’³ FAZ 4: E-ticaret ve Ã–deme
**Ã–ncelik:** ğŸ”´ Kritik

### 4.1 Stripe Entegrasyonu
- [ ] **4.1.1** Stripe hesabÄ± oluÅŸtur ve yapÄ±landÄ±r
- [ ] **4.1.2** Stripe SDK kurulumu
- [ ] **4.1.3** ÃœrÃ¼nler ve fiyatlar oluÅŸtur
- [ ] **4.1.4** Checkout session oluÅŸturma
- [ ] **4.1.5** Payment intent flow
- [ ] **4.1.6** Stripe webhook handler - âœ… Faz 3.7'den taÅŸÄ±ndÄ± (15 Ocak 2026)
  - [ ] Webhook endpoint oluÅŸtur (`POST /api/webhooks/stripe`)
  - [ ] Webhook signature doÄŸrulama
  - [ ] Payment success/failure event handling
  - [ ] Order status gÃ¼ncelleme
- [ ] **4.1.7** Test modu ile test et

### 4.2 Ä°yzico Entegrasyonu (TÃ¼rkiye)
- [ ] **4.2.1** Ä°yzico hesabÄ± oluÅŸtur
- [ ] **4.2.2** Ä°yzico SDK kurulumu
- [ ] **4.2.3** Ã–deme formu entegrasyonu
- [ ] **4.2.4** 3D Secure desteÄŸi
- [ ] **4.2.5** Ä°yzico webhook handler - âœ… Faz 3.7'den taÅŸÄ±ndÄ± (15 Ocak 2026)
  - [ ] Webhook endpoint oluÅŸtur (`POST /api/webhooks/iyzico`)
  - [ ] Webhook signature doÄŸrulama
  - [ ] Payment success/failure event handling
  - [ ] Order status gÃ¼ncelleme
- [ ] **4.2.6** Callback handler (3D Secure sonrasÄ±)
- [ ] **4.2.7** Test modu ile test et

### 4.3 SipariÅŸ YÃ¶netimi
- [ ] **4.3.1** Checkout sayfasÄ±
- [ ] **4.3.2** SipariÅŸ Ã¶zeti component
- [x] **4.3.3** Sepet Sistemi (23 Ocak 2026) - ğŸ”´ **Ã–NEMLÄ°** | ğŸ”´ DO - âœ… **TAMAMLANDI (25 Ocak 2026)**
  - [x] Sepet state management (Context API) âœ… (`contexts/CartContext.tsx`)
  - [x] Sepet sayfasÄ± (`/cart`) âœ… (`app/cart/page.tsx`)
  - [x] Sepet API endpoints âœ… (`app/api/cart/route.ts`)
    - [x] GET /api/cart - Sepeti getir
    - [x] POST /api/cart - Sepete ekle (validation, ebook dependency kontrolÃ¼)
    - [x] DELETE /api/cart - Sepetten Ã§Ä±kar
  - [x] Cart persistence (localStorage) âœ…
  - [x] Multi-item cart support âœ…
  - [x] **Sepete ÃœrÃ¼n Ekleme MantÄ±ÄŸÄ±:**
    - [x] Hardcopy: "Add to Cart" butonu â†’ Sepete hardcopy ekle (ebook kontrolÃ¼ yapÄ±lÄ±yor) âœ…
    - [x] Sepet icon'unda item sayÄ±sÄ± gÃ¶sterimi âœ… (Header'da gerÃ§ek state)
    - [x] Sepet sayfasÄ± (Ã¼rÃ¼n listesi, fiyat, remove butonu) âœ…
    - [x] Cart summary (subtotal, shipping, total) âœ…
    - [x] Empty state âœ…
  - [ ] Ebook sepete ekleme (sonraki faz - pricing sayfasÄ±ndan)
- [ ] **4.3.4** Ã–deme baÅŸarÄ±lÄ± sayfasÄ±
- [ ] **4.3.5** SipariÅŸ durumu takibi (kullanÄ±cÄ± tarafÄ±)
- [ ] **4.3.6** Email bildirimleri
- [ ] **4.3.7** SipariÅŸ API'leri (Backend) - ğŸ†• **25 Ocak 2026**
  - [ ] `GET /api/orders` - KullanÄ±cÄ±nÄ±n sipariÅŸlerini listele (kullanÄ±cÄ± iÃ§in)
  - [ ] `GET /api/orders/:id` - SipariÅŸ detayÄ±nÄ± getir (kullanÄ±cÄ± iÃ§in)
  - [ ] `POST /api/orders/:id/cancel` - SipariÅŸ iptal talebi (kullanÄ±cÄ± iÃ§in)
  - [ ] `GET /api/orders/:id/download` - SipariÅŸ indirme linki (kullanÄ±cÄ± iÃ§in)
  - [ ] `GET /api/admin/orders` - TÃ¼m sipariÅŸleri listele (admin iÃ§in, filtreleme, arama, sayfalama)
  - [ ] `GET /api/admin/orders/:id` - SipariÅŸ detayÄ±nÄ± getir (admin iÃ§in, tam bilgiler)
  - [ ] `PATCH /api/admin/orders/:id` - SipariÅŸ durumu gÃ¼ncelle (admin iÃ§in)
  - [ ] `POST /api/admin/orders/:id/notes` - SipariÅŸ notu ekle (admin iÃ§in)
  - [ ] `POST /api/admin/orders/:id/refund` - Ä°ade iÅŸlemi (admin iÃ§in)
  - [ ] `GET /api/admin/orders/stats` - SipariÅŸ istatistikleri (admin iÃ§in)
  - [ ] `POST /api/admin/orders/export` - SipariÅŸ export (CSV/Excel) (admin iÃ§in)
- [ ] **4.3.8** KullanÄ±cÄ± API'leri (Backend - Admin) - ğŸ†• **25 Ocak 2026**
  - [ ] `GET /api/admin/users` - TÃ¼m kullanÄ±cÄ±larÄ± listele (admin iÃ§in, filtreleme, arama, sayfalama)
  - [ ] `GET /api/admin/users/:id` - KullanÄ±cÄ± detayÄ±nÄ± getir (admin iÃ§in, tam bilgiler)
  - [ ] `GET /api/admin/users/:id/books` - KullanÄ±cÄ±nÄ±n kitaplarÄ±nÄ± listele (admin iÃ§in)
  - [ ] `GET /api/admin/users/:id/orders` - KullanÄ±cÄ±nÄ±n sipariÅŸlerini listele (admin iÃ§in)
  - [ ] `GET /api/admin/users/:id/activity` - KullanÄ±cÄ± aktivite loglarÄ± (admin iÃ§in)
  - [ ] `PATCH /api/admin/users/:id` - KullanÄ±cÄ± durumu gÃ¼ncelle (aktif/pasif/ban) (admin iÃ§in)
  - [ ] `POST /api/admin/users/:id/notes` - KullanÄ±cÄ± notu ekle (admin iÃ§in)
  - [ ] `GET /api/admin/users/stats` - KullanÄ±cÄ± istatistikleri (admin iÃ§in)

### 4.4 FiyatlandÄ±rma Sistemi
- [ ] **4.4.1** Sayfa sayÄ±sÄ±na gÃ¶re fiyatlandÄ±rma (10/15/20 sayfa)
- [ ] **4.4.2** E-book vs BasÄ±lÄ± kitap fiyatlarÄ±
- [ ] **4.4.3** Ä°ndirim kodu sistemi (gelecekte)
- [ ] **4.4.4** Ãœcretsiz kapak hakkÄ± takibi
- [ ] **4.4.10** Bot KorumasÄ± - CAPTCHA Entegrasyonu (25 Ocak 2026)
  - [ ] hCaptcha veya reCAPTCHA entegrasyonu
  - [ ] Cover generation Ã¶ncesi CAPTCHA kontrolÃ¼
  - [ ] Rate limiting ile birlikte Ã§alÄ±ÅŸacak ÅŸekilde yapÄ±landÄ±rma
  - [ ] Unauthenticated users iÃ§in zorunlu, authenticated users iÃ§in opsiyonel
- [ ] **4.4.7** YurtdÄ±ÅŸÄ± Åirket Kurulumu (23 Ocak 2026)
  - ÃœrÃ¼nÃ¼ yurtdÄ±ÅŸÄ±nda satabilmek iÃ§in TR dÄ±ÅŸÄ±nda bir yerde ÅŸirket olmalÄ±
  - Stripe Atlas diye bizim iÃ§in ÅŸirket aÃ§an yapÄ±sÄ± var
  - BaÅŸvuru hazÄ±rlanacak ve bakÄ±lacak
  - AynÄ± zamanda Firstbase diye bir yerde var, onlara da bakmak lazÄ±m
  - Hangisi olursa olsun, yurtdÄ±ÅŸÄ± ÅŸirket kurulumu gerekli
  - **Kategori:** Yasal / Ä°ÅŸ GeliÅŸtirme
  - **Ã–ncelik:** ğŸŸ¡ Ã–nemli
- [ ] **4.4.8** Abonelik Modeli AraÅŸtÄ±rmasÄ± (23 Ocak 2026)
  - Abonelik modeli ile satÄ±ÅŸ dÃ¼ÅŸÃ¼nÃ¼lecek
  - NasÄ±l bir ÅŸekilde entegre edilebilir
  - Abone olanlara aylÄ±k x adet kitap gibi mi yada daha farklÄ± bir ÅŸey gibi dÃ¼ÅŸÃ¼nÃ¼lecek
  - AraÅŸtÄ±rÄ±lmasÄ± gereken konu
  - Subscription model tasarÄ±mÄ± (monthly, yearly)
  - Kitap limitleri (aylÄ±k x adet)
  - FiyatlandÄ±rma stratejisi
  - Stripe Subscription entegrasyonu
  - Subscription management UI
- [x] **4.4.5** SatÄ±ÅŸ ve sepet kurgusu (23 Ocak 2026) | âœ… TamamlandÄ± (FAZ4_4_5_IMPLEMENTATION.md)
  - **GÃ¼ncelleme (23 Ocak 2026):** Sadece kitap kapaÄŸÄ± Ã¼cretsiz olacak (2 sayfa deÄŸil)
  - Ãœcretsiz kapak (draft) Ã¼zerinden eÄŸer satÄ±n alÄ±m yaparsa kalan sayfalara generate yaptÄ±rabilmeliyiz
  - Ã–rneÄŸin 10 sayfa lazÄ±msa, zaten karakter ve kapak yaptÄ±ysak aslÄ±nda 8 sayfa daha yapacaÄŸÄ±z gibi
  - Draft kitap (sadece kapak) â†’ SatÄ±n alma â†’ Kalan sayfalar generate
  - Ne noktada para isteyeceÄŸiz? (DÃ¼ÅŸÃ¼nÃ¼lecek)
  - Hem ebook satÄ±ÅŸ hem de ebook almÄ±ÅŸ kullanÄ±cÄ±ya hardcopy satÄ±ÅŸ
  - Sepet sistemi ve Ã¶deme akÄ±ÅŸÄ± tasarlanmalÄ±
- [x] **4.4.9** ÃœrÃ¼n SatÄ±n Alma AkÄ±ÅŸÄ± (25 Ocak 2026) | ğŸ”´ DO - âœ… **KISMEN TAMAMLANDI (25 Ocak 2026)**
  - [x] **Hardcopy SatÄ±n Alma AkÄ±ÅŸÄ±:** âœ…
    - [x] My Library'de hardcopy butonu (sadece completed ebook'lar iÃ§in) âœ…
    - [x] Toplu seÃ§im ve sepete ekleme âœ… (checkbox'lar, bulk actions bar)
    - [x] Tek kitap sepete ekleme âœ…
    - [x] Sepete hardcopy ekleme (ebook kontrolÃ¼ yapÄ±lÄ±yor) âœ…
    - [x] Sepet sayfasÄ±nda hardcopy item'larÄ± âœ…
    - [x] `POST /api/cart` - Sepete Ã¼rÃ¼n ekleme (hardcopy) âœ…
    - [x] Backend kontrolÃ¼: API'de hardcopy eklenirken ebook kontrolÃ¼ âœ…
  - [ ] **Ebook SatÄ±n Alma AkÄ±ÅŸÄ±:** (Sonraki faz)
    - [ ] Pricing sayfasÄ±ndan sepete ebook ekleme
    - [ ] Checkout sayfasÄ±
    - [ ] Ã–deme entegrasyonu
  - [ ] **Free Cover OluÅŸturma:** (Sonraki faz)
    - [ ] Ãœcretsiz kapak oluÅŸturma
    - [ ] Draft status
    - [ ] SatÄ±n alma sonrasÄ± kalan sayfalar generate
  - [x] **Kurallar:** âœ…
    - [x] Ebook olmadan hardcopy satÄ±n alÄ±namaz âœ… (API validation)
    - [x] Hardcopy butonu sadece completed ebook'lar iÃ§in gÃ¶rÃ¼nÃ¼r âœ…
    - [x] Sepet kontrolÃ¼: Hardcopy eklenirken ebook kontrolÃ¼ yapÄ±lÄ±yor âœ…
  - [x] **UI/UX:** âœ…
    - [x] Dashboard'da kitap kartÄ±nda "Add to Cart (Hardcopy)" butonu âœ…
    - [x] Sadece completed kitaplar iÃ§in buton gÃ¶sterimi âœ…
    - [x] Toplu seÃ§im iÃ§in checkbox'lar ve bulk actions bar âœ…
- [ ] **4.4.6** Hardcopy sadece TR - YabancÄ± kullanÄ±cÄ±lar iÃ§in bilgilendirme (23 Ocak 2026)
  - Hardcopy ÅŸu an iÃ§in sadece TÃ¼rkiye'de var
  - YabancÄ± Ã¼lkeden girenler iÃ§in: Kapat vs iÅŸlemleri gibi
  - Ebook alabilir ama baskÄ± alamaz - satÄ±n alma sÄ±rasÄ±nda bu bilgi verilmeli
  - Checkout sayfasÄ±nda Ã¼lke kontrolÃ¼ ve bilgilendirme mesajÄ±
  - **UI Bilgilendirmesi (26 Ocak 2026):**
    - Pricing sayfasÄ±nda hardcopy kartÄ±nda "Currently available only in Turkey" bilgisi gÃ¶sterilmeli
    - Hardcopy butonlarÄ± (My Library, Sepet, vb.) TR dÄ±ÅŸÄ± kullanÄ±cÄ±lar iÃ§in disabled olmalÄ± veya bilgilendirme mesajÄ± gÃ¶sterilmeli
    - "Hardcopy is currently only available in Turkey. We're working on expanding to more countries soon!" gibi bir mesaj eklenmeli
    - DiÄŸer Ã¼lkelerde zamanla hardcopy desteÄŸi eklenecek, bu bilgi UI'da belirtilmeli
- [ ] **4.4.7** Gelato.com Entegrasyonu - TR DÄ±ÅŸÄ± Hardcopy BaskÄ± (26 Ocak 2026)
  - **Gelato.com Print-on-Demand Entegrasyonu:** https://www.gelato.com/ Ã¼zerinden TR dÄ±ÅŸÄ±ndaki bazÄ± Ã¼lkelerde hardcopy baskÄ± alÄ±p satÄ±ÅŸ yapabilme
  - Gelato.com API entegrasyonu araÅŸtÄ±rÄ±lacak ve implementasyon planÄ± yapÄ±lacak
  - Desteklenen Ã¼lkeler listesi ve fiyatlandÄ±rma stratejisi belirlenecek
  - Gelato.com Ã¼zerinden sipariÅŸ akÄ±ÅŸÄ± tasarlanacak (kullanÄ±cÄ± sipariÅŸ verir â†’ Gelato'ya yÃ¶nlendirilir veya otomatik sipariÅŸ oluÅŸturulur)
  - Gelato.com ile entegrasyon sonrasÄ± TR dÄ±ÅŸÄ± Ã¼lkeler iÃ§in hardcopy satÄ±ÅŸÄ± aktif hale gelecek
  - UI'da Ã¼lkeye gÃ¶re hardcopy kullanÄ±labilirliÄŸi gÃ¶sterilecek (TR: yerel baskÄ±, diÄŸer Ã¼lkeler: Gelato.com)

---

